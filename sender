#include <fcntl.h>
#include <mqueue.h>
#include <sys/stat.h>

#include <String.h>
#include <stdlib.h>
#include <stdio.h>
#define MQ_NAME "/mq_cola_queue"

typedef struct Massage 
{
    char mssg[80];
};

int main(void){

    struct mq_attr attribut = {
        .mq_flags        = 0,
        .mqmaxmessages   = 10,
        .mq_curmessages  = 0,
        .mq_msgsize = sizeof(Massage)
    };

    mqd_t queue = mq_open(MQ_NAME, O_CREAT | O_WRONLY, S_IRUSR | S_IWUSR, &attribut);

    Massage struct_to_send;
    strcpy(struct_to_send.mssg, "Das ist meine Nachricht");

    mq_send(queue, (char *) & struct_to_send, sizeof(struct_to_send), 1);

    fprintf(stdout, "Press any key to finish\n");
    getchar();

    mq_close(queue);
    mq_unlink(MQ_NAME);

    return EXIT_SUCCESS;

    
    
}
